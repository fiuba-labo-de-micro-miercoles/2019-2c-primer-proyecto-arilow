.EQU 		SERVO_MAX = 2600
.EQU 		SERVO_MIN = 500
.INCLUDE "PCA9685.INC"

MOVEMENT_SETUP:
	RCALL 	PCA9685_SETUP
	RET

MOVEMENT_TEST:
	RCALL 	MOVEMENT_DELAY
	SBI 	PORTB,5
	LDI 	R23,0x00
	LDI 	R24,LOW(SERVO_MIN)
	LDI 	R25,HIGH(SERVO_MIN)
	RCALL 	PCA9685_MOVE
	RCALL 	MOVEMENT_DELAY
	CBI 	PORTB,5
	LDI 	R23,0x00
	LDI 	R24,LOW(SERVO_MAX)
	LDI 	R25,HIGH(SERVO_MAX)
	RCALL 	PCA9685_MOVE
	RET


MOVEMENT_DELAY:
	push r22
	push r24
	push r25
	ldi r22, 100 ;
MOVEMENT_OUTER_LOOP:
	ldi r24, low(90)
	ldi r25, high(90)
MOVEMENT_DELAY_LOOP:
	adiw r25:r24,1
	brne MOVEMENT_DELAY_LOOP
	nop
	dec r22
	brne MOVEMENT_OUTER_LOOP
	pop r25
	pop r24
	pop r22
	ret
