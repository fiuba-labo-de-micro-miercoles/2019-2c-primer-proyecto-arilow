.INCLUDE 	"M328PDEF.INC"

.CSEG

.ORG 	0x00
	RJMP	MAIN
.ORG 	0x02
	RJMP 	EXT_INT0
.ORG 	0x1E
	RJMP	TIM1_OVF

;INTERRUPCIONES



.ORG 	INT_VECTORS_SIZE
MAIN:
	ldi r16,low(RAMEND)
	out spl,r16
	ldi r16,high(RAMEND)
	out sph,r16
	
	SBI DDRB,5

	
	RCALL	MOVEMENT_SETUP
;	RCALL 	HCSR04_SETUP
;	CLR 	R21
;	CLR		R22
	
	
;	LDI 	R26,LOW(1000)
;	LDI 	R27,HIGH(1000)
;	RCALL 	MOVEMENT_LEG_1
;	SBI PORTB,5
;	LDI 	R26,LOW(1400)
;	LDI 	R27,HIGH(1400)
;	RCALL 	MOVEMENT_LEG_2
;	CBI PORTB,5
;	LDI 	R26,LOW(1400)
;	LDI 	R27,HIGH(1400)
;	RCALL 	MOVEMENT_LEG_3
;	SBI PORTB,5
;	LDI 	R26,LOW(800)
;	LDI 	R27,HIGH(800)
;	RCALL 	MOVEMENT_LEG_4
;	CBI PORTB,5

MAIN_LOOP:
	LDI 	R26,LOW(600)
	LDI 	R27,HIGH(600)
	RCALL 	MOVEMENT_LEG_1
	LDI 	R26,LOW(1400)
	LDI 	R27,HIGH(1400)
	RCALL 	MOVEMENT_LEG_1

	RJMP 	MAIN_LOOP


TURN_ON:
	SBI PORTB,5
	RET


TURN_OFF:
	CBI PORTB,5
	RET



;error
ERRLOOP:
	RJMP	ERRLOOP


.INCLUDE 	"MOVEMENT.INC"
.INCLUDE 	"HCSR04.INC"
